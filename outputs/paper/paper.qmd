---
title: "Paper 2"
author: 
  - Gavin Crooks
  - Samarth Rajani
thanks: "Code and data are available at: LINK.https://github.com/Crooksyyy/The-Effects-of-Social-Media , Original data available https://www.openicpsr.org/openicpsr/project/112081/version/V1/view"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
toc: true
bibliography: references.bib 
nocite: |
  @*
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(knitr)
cleaned_data <- read_csv(here::here("outputs/Data/analysis_data.csv"))

```


# Introduction {#intro}
Household income is defined as the gross income earned by all members in a household above 15 years of age [@hhld]. Over the years, it has been debated whether household incomes at all affect one’s affiliation towards a political school of thought. It is a reasonable hypothesis to assume a sort of relationship between income and voting either Democrat or Republican, as both parties have different economic outlooks thereby affecting incomes differently. Maybe higher income inequality polarizes political leaning further. Therefore, it is in our best interests to study whether the poor vote to improve their quality of life. 

In ‘Income Inequality and Partisan Voting in the United States’, Andrew Gelman, Lane Kenworthy and Yu-Sung Su [@lane] make a case for higher earning Americans voting Republican, whereas Jeff Madrick [@article] argues how working-class Americans voted against their interests in voting Republican. Conflicting theories have emerged, and we intend on tackling this issue at hand of whether different income brackets tend to vote differently. 



Our data has been obtained from ‘The Welfare Effects of Social Media’ [@paper] .
Our code is supported by the following packages [@citeR] [@tidy] [@her] [@knitr]


# Data {#sec-data}
## Data Introduction {#sec-dataintro}
The data used in this paper is from (cite og paper). The data used in the paper is extremely complicated as it combines numerous data sets to complete their analysis. In this paper, we wanted to simplify the data to determine if their paper had underlying biases within the data. To do this we focused on one of their eleven data sets, baseline dataset as it was the most comprehensive. This data was collected through a facebook ad. The respondents answered a number of questions including questions about income, ethnicity, family, political beliefs and political following. THis is a very useful data set outside the scope of the original paper as it can be analyzed to answer a number of questions. The data set was cleaned to focus on respondents income, race and how closely they follow politics. This provided a data set of approximately 6000 complete responses after removing unfinished responses. This was a substantial decrease from the orignal 24000 responses in the data. 

## Income Data {#sec-income_data}
The variable within the data was the income variable. The questionnaire included a categorical value for the the household income of respondents. The data can be visualized in @figure1. This graph illustrates that the least number of households make greater than 100,000 USD, below 20,000USD or preferred not to answer. This graph also shows what the categorical option were for the respondents to the questionnaire. @figure1 closely resembles the expected distribution of USA household income. As expected in any income distribution the majority of responses fall within the average income ranges of the USA, between 20,000USD and 100,000USD. These factors indicate that the data set has an accurate representation of household income. 
```{r}
#| label: fig-figure1
#| fig-cap: "Distribution of Income from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false

ggplot(cleaned_data, aes(x = reorder(hhld_inc, -table(hhld_inc)[hhld_inc]), fill = hhld_inc)) +
  geom_bar() +
  labs(x = "Household Income",
       y = "Number of Respondents") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = FALSE) # Parts of the code from Stack overflow 

```
## Ethnicity Data {#sec-race_data}
The second question of the data that we have included in our analysis is the ethnicity of the respondents. This again is a categorical variable, that the individual self identifies their own ethnicity. The response options included Asian or Pacific Islander, White / Caucasian, Hispanic, Black or African American and other. @race_dist shows the percentage of respondents in each  with the overwhelming majority of responses being Caucasian at nearly 70%. This is actually less than the most recent estimates by the United States government which estimate over 75% of the population is Caucasian (cite us gov). The data also has an over representation of Asian and Native Americans. This results in an under representation of Hispanic and African American populations. 


https://www.census.gov/quickfacts/fact/table/US/PST045222


```{r} 
#| label: tbl-race_dist
#| tbl-cap: "Percentage of each Ethnicity from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false
proportion_table <- cleaned_data %>%
  group_by(race) %>%
  summarise((proportion = n() / nrow(cleaned_data))*100) 
kable(proportion_table,
      col.names = c("Ethnicity", "Percentage of Responses")
)
```

## Politics Data {#sec-pol_data}

The third variable in the data that is included in our analysis is a variable of respondents self identifying how closely they follow politics. This is another categorical variable measured as Not at all closely, Somewhat closely, Rather closely and  Very closely. This variable faces many problems as this categorical scale is not consistent across respondents. To be specific we mean someone who identifies as someone who does follows Not at all closely can be following politics more than someone who identifies as Somewhat closely. This is a measurement issue within to the questions asked in the survey and all self identifying variables in general. @figure2 shows the quantity of respondents in each group. The most common response is that they follow somewhat closely and the other responses are relatively even. 
```{r}
#| label: fig-figure2
#| fig-cap: "How Closely People Follow Mr.Donald Trump from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false

ggplot(cleaned_data, aes(x = "", fill = follow_trump)) +
  geom_bar() +
  coord_polar("y") +
  labs(fill = "Legend") +
  theme(axis.title = element_blank())


```
## Missing Data {#sec-Missing_data}


```{r}
#| label: fig-figure4
#| fig-cap: "Number of Respondents who follow Donald Trump at different levels by Race"
#| warning: false
#| message: false
#| echo: false
# Parts of this code from R-charts
#https://r-charts.com/part-whole/stacked-bar-chart-ggplot2/
# Assisted by Chat GPT3.5 - view full chat in inputs/llms/usage.txt
ggplot(cleaned_data, aes(x = follow_trump, fill = race)) +
  geom_bar(position = 'stack', color = 'black', stat = 'count') +
  labs(title = "Number of People Following Trump by Race",
       x = "Follows Trump",
       y = "Count") +
  scale_fill_manual(values = c('White / Caucasian' = 'lightblue', 'Black or African American' = 'lightcoral', 'Asian or Pacific Islander' = 'lightgreen', 'Hispanic' = 'plum',
                               'Other  (please specify)' = 'lightgoldenrodyellow')) +
  theme_minimal()

```
```{r}
#| label: fig-figure3
#| fig-cap: "Number of Respondents who follow Donald Trump at different levels by Household Income"
#| warning: false
#| message: false
#| echo: false

## Assisited by Chat GPT3.5 - view full chat in inputs/llms/usage.txt
#Decrease from 12 income groups to 4 
cleaned_data <- cleaned_data %>%
  mutate(income_group = case_when(
    hhld_inc %in% c("$0 to $9,999", "$10,000 to $19,999") ~ "$0 to $19,999",
    hhld_inc %in% c("$20,000 to $29,999", "$30,000 to $39,999", "$40,000 to $49,999") ~ "$20,000 to $49,999",
    hhld_inc %in% c("$50,000 to $59,999", "$60,000 to $74,999", "$75,000 to $99,999") ~ "$50,000 to $99,999",
    hhld_inc %in% c("$100,000 to $124,999", "$125,000 to $149,999", "$150,000 and up") ~ "$100,000 and up",
    TRUE ~ "Prefer not to answer"
  ))

ggplot(cleaned_data, aes(x = follow_trump, fill = income_group)) +
  geom_bar(position = 'stack', color = 'black', stat = 'count') +
  labs(x = "Follows Trump",
       y = "Number of Responses") +
  scale_fill_manual(values = c(
    "$0 to $19,999" = 'lightblue',
    "$20,000 to $49,999" = 'lightcoral',
    "$50,000 to $99,999" = 'lightgreen',
    "$100,000 and up" = 'plum',
    "Unknown or Prefer not to answer" = 'lightgrey'
  )) +
  theme_minimal()

```
# Results

```{r}
# Create a table of proportions
income_follow_table <- table(cleaned_data$follow_trump, cleaned_data$income_group)
income_proportions <- prop.table(income_follow_table, margin = 1) * 100 

table1 <- tibble(income_proportions, colnames(c("Income Group", "Follows Trump" )))
show(table1)
```

This papers goal was to identify if lower income household voted against their own interest. To understand this relationship we used the variable for how closely a respondent follows Mr. Donald Trump as our measurement of subscription to Republican ideas. Using this measurement, we organized the proportion of individuals by income class to how closely they follow Mr. Donald Trump in @fig-figure3. This graph shows that a proportional amount of each income class follows Mr. Donald Trump at similar levels across all income levels. Specifically, we mean the percentage of individuals  follow Mr. Donald Trump at different levels is the same no matter the income class. This means we can not conclude that income class impacts how closely individuals follow Mr. Donald Trump, and therefor, cannot conclude that different income levels subscribe to republican ideas more than the other. 

To further our analysis we computed the same graph however organized by race not income @fig-figure4. This resulted in a similar result as race is proportional between all levels of following Mr. Donald Trump. Therefore, consistent across races at to following republican rhetoric. Again, this means the same percentage of people that follow Mr. Donald Trump at different levels is the same for each race. Obviously, this is more difficult to conclude for minorities as their representation within the data set is so small as stated in @sec-race_data 

Overall, the results of this analysis were inconclusive to measure how income impacts individuals propensity to follow republican rhetoric. There are many reasons this could be true and as stated in the @intro there are multiple schools of thought previously studies on the topic. 

# Discussion
like to incluse variables like state etc data set too small/ incomplete for that
## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}



\newpage


# References


