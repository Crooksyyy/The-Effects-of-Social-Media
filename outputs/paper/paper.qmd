---
title: "Paper 2"
author: 
  - Gavin Crooks
  - Samarth Rajani
thanks: "Code and data are available at: LINK.https://github.com/Crooksyyy/The-Effects-of-Social-Media , Original data available https://www.openicpsr.org/openicpsr/project/112081/version/V1/view"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
toc: true
bibliography: references.bib 
nocite: |
  @*
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(knitr)
cleaned_data <- read_csv(here::here("outputs/data/analysis_data.csv"))

```


# Introduction {#sec-intro}
Household income is defined as the gross income earned by all members in a household above 15 years of age [@hhld]. Over the years, it has been debated whether household incomes at all affect one’s affiliation towards a political school of thought. It is a reasonable hypothesis to assume a sort of relationship between income and voting either Democrat or Republican, as both parties have different economic outlooks thereby affecting incomes differently. Maybe higher income inequality polarizes political leaning further. Therefore, it is in our best interests to study whether the poor vote to improve their quality of life. 

In ‘Income Inequality and Partisan Voting in the United States’, Andrew Gelman, Lane Kenworthy and Yu-Sung Su [@lane] make a case for higher earning Americans voting Republican, whereas Jeff Madrick [@Madrick_2020] argues how working-class Americans voted against their interests in voting Republican. Conflicting theories have emerged, and we intend on tackling this issue at hand of whether different income brackets tend to vote differently. 

The remainder of this paper is structured as follows. @sec-data will intorduce the data set and the variables it contains. @sec-results will display the findings of our data in relation to our paper.   @sec-data focuses on the strength and weaknesses of our paper.  


Our data has been obtained from ‘The Welfare Effects of Social Media’ [@paper] .
Our code is supported by the following packages [@citeR] [@tidy] [@her] [@knitr]


# Data {#sec-data}
## Data Introduction {#sec-dataintro}

The data for this paper was collected from the replication package of the paper ‘The Welfare Effects of Social Media’[@paper] The authors from that data had collected this data themselves using an online survey platform called Qulatrics, inquiring about personal information such as personal names, IP addresses, extent of by which the subjects follow politics, etc. Notably the dataset would contain a lot of confidential information, that if released in the replication package would cause ethical problems. As a result, the authors included the de-identified versions of their data collected, which was used in our analysis too.  

## Income Data {#sec-income_data}

Our key variables of interest include household income. The survey participants were offered options in bins starting at 0 to 9,999 US dollar range, with every succeeding bin also being 9,999 USD wide. The bins went up to a ceiling of 50,000 USD per annum, then every next bin was 25,000 USD wide until a ceiling of 150,000 USD. In our analysis we combine the bins above 9,999 into – 20,000 to 49,999, 50,000 to 99,999 and the rest being 100,000 and up. The option of ‘Prefer not to answer’ was also available, and the entries with that response were dropped. The distribution of the data can be seen in @fig-figure1 .

```{r}
#| label: fig-figure1
#| fig-cap: "Distribution of Income from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false

ggplot(cleaned_data, aes(x = reorder(hhld_inc, -table(hhld_inc)[hhld_inc]), fill = hhld_inc)) +
  geom_bar() +
  labs(x = "Household Income",
       y = "Number of Respondents") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = FALSE) # Parts of the code from Stack overflow 

```

## Politics Data {#sec-pol_data}

Another variable of use is the extent to which the subjects follow Mr. Donald Trump, leader of the Republican Party. The possible responses were ‘Not at all closely', 'Somewhat closely,’ ‘Rather closely’ and ‘Very Closely,’ and the respondents could select one of these options which will become our measure of measuring subscription to Republican ideas. This data is represented using a pie chart in @fig-figure2. 

```{r}
#| label: fig-figure2
#| fig-cap: "How Closely People Follow Mr.Donald Trump from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false

ggplot(cleaned_data, aes(x = "", fill = follow_trump)) +
  geom_bar() +
  coord_polar("y") +
  labs(fill = "Legend") +
  theme(axis.title = element_blank())


```

## Ethnicity Data {#sec-race_data}

```{r} 
#| label: tbl-race_dist
#| tbl-cap: "Percentage of each Ethnicity from Responses in a facebook ad"
#| warning: false
#| message: false
#| echo: false
proportion_table <- cleaned_data %>%
  group_by(race) %>%
  summarise((proportion = n() / nrow(cleaned_data))*100) 
kable(proportion_table,
      col.names = c("Ethnicity", "Percentage of Responses")
)
```


# Results {#sec-results}

This papers goal was to identify if lower income household voted against their own interest. To understand this relationship we used the variable for how closely a respondent follows Mr. Donald Trump as our measurement of subscription to Republican ideas. Using this measurement, we organized the proportion of individuals by income class to how closely they follow Mr. Donald Trump in @fig-figure3. This graph shows that a proportional amount of each income class follows Mr. Donald Trump at similar levels across all income levels. Specifically, we mean the percentage of individuals  follow Mr. Donald Trump at different levels is the same no matter the income class. This means we can not conclude that income class impacts how closely individuals follow Mr. Donald Trump, and therefor, cannot conclude that different income levels subscribe to republican ideas more than the other. 

```{r}
#| label: fig-figure3
#| fig-cap: "Number of Respondents who follow Donald Trump at different levels by Household Income"
#| warning: false
#| message: false
#| echo: false

## Assisited by Chat GPT3.5 - view full chat in inputs/llms/usage.txt
#Decrease from 12 income groups to 4 
cleaned_data <- cleaned_data %>%
  mutate(income_group = case_when(
    hhld_inc %in% c("$0 to $9,999", "$10,000 to $19,999") ~ "$0 to $19,999",
    hhld_inc %in% c("$20,000 to $29,999", "$30,000 to $39,999", "$40,000 to $49,999") ~ "$20,000 to $49,999",
    hhld_inc %in% c("$50,000 to $59,999", "$60,000 to $74,999", "$75,000 to $99,999") ~ "$50,000 to $99,999",
    hhld_inc %in% c("$100,000 to $124,999", "$125,000 to $149,999", "$150,000 and up") ~ "$100,000 and up",
    TRUE ~ "Prefer not to answer"
  ))

ggplot(cleaned_data, aes(x = follow_trump, fill = income_group)) +
  geom_bar(position = 'stack', color = 'black', stat = 'count') +
  labs(x = "Follows Trump",
       y = "Number of Responses") +
  scale_fill_manual(values = c(
    "$0 to $19,999" = 'lightblue',
    "$20,000 to $49,999" = 'lightcoral',
    "$50,000 to $99,999" = 'lightgreen',
    "$100,000 and up" = 'plum',
    "Unknown or Prefer not to answer" = 'lightgrey'
  )) +
  theme_minimal()

```

To further our analysis we computed the same graph however organized by race not income @fig-figure4. This resulted in a similar result as race is proportional between all levels of following Mr. Donald Trump. Therefore, consistent across races at to following republican rhetoric. Again, this means the same percentage of people that follow Mr. Donald Trump at different levels is the same for each race. Obviously, this is more difficult to conclude for minorities as their representation within the data set is so small as stated in @sec-race_data 

```{r}
#| label: fig-figure4
#| fig-cap: "Number of Respondents who follow Donald Trump at different levels by Race"
#| warning: false
#| message: false
#| echo: false
# Parts of this code from R-charts
#https://r-charts.com/part-whole/stacked-bar-chart-ggplot2/
# Assisted by Chat GPT3.5 - view full chat in inputs/llms/usage.txt
ggplot(cleaned_data, aes(x = follow_trump, fill = race)) +
  geom_bar(position = 'stack', color = 'black', stat = 'count') +
  labs(title = "Number of People Following Trump by Race",
       x = "Follows Trump",
       y = "Count") +
  scale_fill_manual(values = c('White / Caucasian' = 'lightblue', 'Black or African American' = 'lightcoral', 'Asian or Pacific Islander' = 'lightgreen', 'Hispanic' = 'plum',
                               'Other  (please specify)' = 'lightgoldenrodyellow')) +
  theme_minimal()

```

Overall, the results of this analysis were inconclusive to measure how income impacts individuals propensity to follow republican rhetoric. There are many reasons this could be true and as stated in the @sec-intro there are multiple schools of thought previously studies on the topic. 


\newpage


# References


